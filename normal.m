function prob = normal(x,upper)
ltone=7.0;
utzero=18.66;
con=1.28;
z = x;
if z < 0
  upper = 1-upper;
  z = -z;
end
if ((z<=ltone)|((upper~=0)&(z>=utzero)))
  y=0.5*z*z;
  if (z>con)
    Alnorm=0.398942280385*exp(-y)/(z-3.8052*0.00000001+1.00000615302/(z+3.98064794*0.0001+1.98615381364/(z-0.151679116635+5.29330324926/(z+4.8385912808-15.1508972451/(z+0.742380924027+30.789933034/(z+3.99019417011))))));
  else
    Alnorm=0.5-z*(0.398942280444-0.399903438504*y/(y+5.75885480458-29.8213557808/(y+2.62433121679+48.6959930692/(y+5.92885724438))));
  end  
else
  Alnorm=0;
end  
if (upper == 0)
  prob = 1-Alnorm;
else
  prob = Alnorm;
end